---
phase: 06-carousel-navigation
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - package.json
  - package-lock.json
  - src/ui/components/mobile/MobileCarousel.tsx
autonomous: true

must_haves:
  truths:
    - "User can swipe horizontally between heatmap and muscle list (NAV-01)"
    - "Dot indicators visually track current slide position (NAV-02)"
    - "Swipe gesture feels smooth with momentum and snap behavior"
  artifacts:
    - path: "src/ui/components/mobile/MobileCarousel.tsx"
      provides: "Swipeable carousel container with dot indicators"
      exports: ["MobileCarousel"]
      min_lines: 60
  key_links:
    - from: "src/ui/components/mobile/MobileCarousel.tsx"
      to: "embla-carousel-react"
      via: "useEmblaCarousel hook"
      pattern: "useEmblaCarousel"
    - from: "MobileCarousel.tsx"
      to: "MobileHeatmap.tsx"
      via: "component import"
      pattern: "import.*MobileHeatmap"
    - from: "MobileCarousel.tsx"
      to: "MobileMuscleList.tsx"
      via: "component import"
      pattern: "import.*MobileMuscleList"
---

<objective>
Create a swipeable carousel container that holds MobileHeatmap and MobileMuscleList as two slides with dot indicators.

Purpose: Enable Instagram-style horizontal swipe navigation between the two mobile views (NAV-01, NAV-02)
Output: MobileCarousel component using embla-carousel-react with physics-based swipe and dot navigation
</objective>

<execution_context>
@./.claude/get-shit-done/workflows/execute-plan.md
@./.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/06-carousel-navigation/06-RESEARCH.md

@src/ui/components/mobile/MobileHeatmap.tsx
@src/ui/components/mobile/MobileMuscleList.tsx
</context>

<tasks>

<task type="auto">
  <name>Task 1: Install embla-carousel-react and create MobileCarousel component</name>
  <files>
    package.json
    package-lock.json
    src/ui/components/mobile/MobileCarousel.tsx
  </files>
  <action>
1. Install embla-carousel-react:
   ```bash
   npm install embla-carousel-react
   ```

2. Create `src/ui/components/mobile/MobileCarousel.tsx` with:
   - Props: `{ profileId: string | null; daysBack?: number }`
   - Use `useEmblaCarousel` with options:
     - `loop: false` (critical: loop breaks with only 2 slides)
     - `dragFree: false` (snap to slides)
     - `startIndex: 0` (NAV-03: default to heatmap)
   - Track selected slide index with `useState` + emblaApi `select` event
   - Structure:
     ```tsx
     <div>
       {/* Carousel viewport */}
       <div className="overflow-hidden" ref={emblaRef}>
         <div className="flex touch-pan-y">
           {/* Slide 1: Heatmap */}
           <div className="flex-[0_0_100%] min-w-0">
             <MobileHeatmap profileId={profileId} daysBack={daysBack} />
           </div>
           {/* Slide 2: Muscle List */}
           <div className="flex-[0_0_100%] min-w-0">
             <MobileMuscleList profileId={profileId} daysBack={daysBack} />
           </div>
         </div>
       </div>

       {/* Dot indicators */}
       <div className="flex justify-center gap-2 py-4" role="tablist">
         {[0, 1].map((index) => (
           <button
             key={index}
             onClick={() => emblaApi?.scrollTo(index)}
             className={/* active: w-4 bg-amber-500, inactive: w-2 bg-primary-600 */}
             role="tab"
             aria-selected={index === selectedIndex}
             aria-label={index === 0 ? 'Body heatmap view' : 'Muscle list view'}
           />
         ))}
       </div>
     </div>
     ```

3. Critical implementation details (from RESEARCH.md):
   - Use `touch-pan-y` class on flex container (allows vertical scroll, prevents horizontal browser scroll)
   - Use `min-w-0` on slides (prevents flex overflow)
   - Subscribe to `emblaApi.on('select', callback)` in useEffect with cleanup
   - Update selectedIndex from `emblaApi.selectedScrollSnap()` in callback
   - Dot button styling: active dot is `w-4 bg-amber-500`, inactive is `w-2 bg-primary-600 active:bg-primary-500`
   - Dot transition: `transition-all duration-200 h-2 rounded-full`

4. Export the component as named export.
  </action>
  <verify>
    - `npm run build` succeeds (no TypeScript errors)
    - `npm run lint` passes
    - embla-carousel-react appears in package.json dependencies
  </verify>
  <done>
    - MobileCarousel.tsx exists with useEmblaCarousel setup
    - Component renders MobileHeatmap and MobileMuscleList as slides
    - Dot indicators track selected slide via emblaApi select event
    - Swipe gesture has smooth physics (loop: false, dragFree: false)
  </done>
</task>

</tasks>

<verification>
```bash
# Build passes
npm run build

# Lint passes
npm run lint

# Component exists with correct structure
grep -l "useEmblaCarousel" src/ui/components/mobile/MobileCarousel.tsx

# Dependency installed
grep "embla-carousel-react" package.json
```
</verification>

<success_criteria>
- embla-carousel-react is installed in package.json
- MobileCarousel component created with TypeScript types
- Component uses useEmblaCarousel with correct options (loop: false)
- Dot indicators respond to slide changes via select event
- Build and lint pass
</success_criteria>

<output>
After completion, create `.planning/phases/06-carousel-navigation/06-01-SUMMARY.md`
</output>
