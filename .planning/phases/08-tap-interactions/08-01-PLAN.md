---
phase: 08-tap-interactions
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - src/ui/components/mobile/MobileMuscleList.tsx
  - src/ui/components/mobile/MuscleDetailModal.tsx
autonomous: true

must_haves:
  truths:
    - "Tapping a muscle row in the list opens the detail pop-up for that muscle"
    - "Group headers still expand/collapse when tapped (no modal)"
    - "Row shows brief visual feedback on tap (iOS-style highlight)"
  artifacts:
    - path: "src/ui/components/mobile/MobileMuscleList.tsx"
      provides: "Tap handlers on muscle rows with modal integration"
      contains: "selectedMuscle"
    - path: "src/ui/components/mobile/MuscleDetailModal.tsx"
      provides: "Single-muscle mode support"
      contains: "muscle"
  key_links:
    - from: "MobileMuscleList.tsx"
      to: "MuscleDetailModal.tsx"
      via: "selectedMuscle state triggers modal render"
      pattern: "selectedMuscle.*useState"
---

<objective>
Add tap interactions to muscle list rows that open the detail modal.

Purpose: Users need to tap any muscle in the list to see its detailed stats (LIST-05).
Output: MobileMuscleList with tappable rows and integrated MuscleDetailModal.
</objective>

<execution_context>
@./.claude/get-shit-done/workflows/execute-plan.md
@./.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@src/ui/components/mobile/MobileMuscleList.tsx
@src/ui/components/mobile/MuscleDetailModal.tsx
@src/core/taxonomy.ts
</context>

<tasks>

<task type="auto">
  <name>Task 1: Add single-muscle mode to MuscleDetailModal</name>
  <files>src/ui/components/mobile/MuscleDetailModal.tsx</files>
  <action>
Add an alternative prop interface to MuscleDetailModal that accepts a single muscle instead of region + muscle arrays:

1. Add optional `muscle` prop of type `ScientificMuscle` as alternative to region-based props
2. When `muscle` prop is provided (and region is null):
   - Use muscle name as the header text
   - Show only that single muscle's stats (no primary/related separation)
   - Modal functions identically otherwise (dismiss, swipe, escape key)
3. Keep existing region-based mode working unchanged for MobileHeatmap

The modal should support EITHER:
- region + primaryMuscles + relatedMuscles (existing mode for heatmap)
- muscle alone (new mode for list)

Update the interface:
```typescript
interface MuscleDetailModalProps {
  isOpen: boolean;
  onClose: () => void;
  // Region mode (existing)
  region?: BodyRegion | null;
  primaryMuscles?: ScientificMuscle[];
  relatedMuscles?: ScientificMuscle[];
  // Single muscle mode (new)
  muscle?: ScientificMuscle | null;
  // Common
  profileId: string | null;
  daysBack?: number;
}
```

In render logic, check if `muscle` is provided first (single-muscle mode), otherwise use region mode.
  </action>
  <verify>TypeScript compiles without errors. Existing MobileHeatmap modal still works.</verify>
  <done>MuscleDetailModal supports both region mode and single-muscle mode via props.</done>
</task>

<task type="auto">
  <name>Task 2: Add tappable rows to MobileMuscleList</name>
  <files>src/ui/components/mobile/MobileMuscleList.tsx</files>
  <action>
Make each muscle row tappable to open the detail modal:

1. Add state for selected muscle:
   ```typescript
   const [selectedMuscle, setSelectedMuscle] = useState<ScientificMuscle | null>(null);
   ```

2. Import MuscleDetailModal and ScientificMuscle type

3. Wrap each muscle row (the div with className="space-y-1") in a button:
   ```typescript
   <button
     onClick={() => setSelectedMuscle(muscle as ScientificMuscle)}
     className="w-full text-left active:bg-primary-700/50 transition-colors duration-75 rounded-md -mx-1 px-1"
   >
     {/* existing row content */}
   </button>
   ```

   Key styling:
   - `w-full text-left` - button fills row width, content aligns left
   - `active:bg-primary-700/50` - iOS-style highlight on tap
   - `transition-colors duration-75` - snappy feedback
   - `rounded-md -mx-1 px-1` - slight padding for better touch target

4. Group headers (the existing button with toggleGroup) remain UNCHANGED - they still expand/collapse

5. Add MuscleDetailModal at the end of the component return:
   ```typescript
   <MuscleDetailModal
     isOpen={selectedMuscle !== null}
     onClose={() => setSelectedMuscle(null)}
     muscle={selectedMuscle}
     profileId={profileId}
     daysBack={daysBack}
   />
   ```

6. Ensure touch targets meet 44px minimum (rows already have p-3 on parent, should be sufficient - verify visually)
  </action>
  <verify>npm run build succeeds. Run dev server and verify: tap muscle row opens modal, tap group header expands/collapses.</verify>
  <done>Muscle rows are tappable with visual feedback, modal opens on tap, group headers still expand/collapse.</done>
</task>

</tasks>

<verification>
- [ ] `npm run build` passes without type errors
- [ ] Tapping any muscle row in list opens modal showing that muscle's stats
- [ ] Tapping group header still expands/collapses (does NOT open modal)
- [ ] Row shows brief highlight on tap (active:bg-primary-700/50)
- [ ] Modal closes via X button, escape key, and swipe down
- [ ] MobileHeatmap modal still works (region mode unchanged)
</verification>

<success_criteria>
LIST-05 requirement satisfied: Users can tap any muscle row to see its detailed weekly sets and target range in a pop-up modal.
</success_criteria>

<output>
After completion, create `.planning/phases/08-tap-interactions/08-01-SUMMARY.md`
</output>
